scale_y_continuous(limits=c(-10,110), breaks=c(0,25,50,75,100))+
ylab("Electrolyte Leakage (% Nitrogen Leakage)") + xlab("Temperature (°C)") +
labs(col="Accession",fill="Accession")+
ggtitle(i)+
theme_bw(base_size = 14)+
theme(legend.position = c(0.8,0.8),
legend.text.align= 1,
legend.text = element_text(size=12),
panel.grid.minor = element_blank(),
legend.background = element_rect(fill="transparent"),
legend.key = element_rect( fill = NA),
panel.border = element_rect(size=1),
axis.text=element_text(color="black"))
)
predL= ((mod1$coefficients[2]))/(1+exp(mod1$coefficients[1]*(log(x)-log(mod1$coefficients[3]))))
print(ggplot()+
geom_line(aes(x=-dat.pred$x+10, y=dat.pred$values, group=dat.pred$ind ), alpha=0.1, size=0.2)+
geom_line(aes(x=-pred$x+10,y=pred$y, col=pred$Accession), lty=2, size=0.7)+
geom_line(aes(x=-x+10, y=predL), size=0.6)+
geom_point(aes(x=subdat$RealT, y=subdat$L, fill=subdat$Accession), shape=21, position = position_dodge(width=2), size=2.5)+
scale_y_continuous(limits=c(-10,110), breaks=c(0,25,50,75,100))+
ylab("Electrolyte Leakage (% Nitrogen Leakage)") + xlab("Temperature (°C)") +
labs(col="Accession",fill="Accession")+
ggtitle(i)+
theme_bw(base_size = 14)+
theme(legend.position = c(0.8,0.8),
legend.text.align= 1,
legend.text = element_text(size=12),
panel.grid.minor = element_blank(),
legend.background = element_rect(fill="transparent"),
legend.key = element_rect( fill = NA),
panel.border = element_rect(size=1),
axis.text=element_text(color="black"))
)
subdat=subset(dat1, Species %in% i)
subdat4=subset(dat4, Accession %in% levels(factor(subdat$Accession)))
mod1=drm((subdat$L)~subdat$posRT, fct=LL.4(fixed=c(NA,0,NA,NA)), start=c(-7.3,60,30), upperl =c(0,90,40) , type="continuous" )
(vc <- vcov(mod1))
coef(summary(mod1))[, "Std. Error"]
sqrt(diag(vc))
require("MASS")
set.seed(345)
nsim <- 5000
sim <- mvrnorm(nsim, mu = coef(mod1),  Sigma = vc)
head(sim)
take <- data.frame(sample(nrow(sim), 100)) ## take 25 simulations at random
colnames(take)="take"
dat.pred=NULL
dat.pred$x=seq(0,95,1)
dat.pred=data.frame(dat.pred)
for (j in take$take){
g=sim[j,1]
m=sim[j,2]
h=sim[j,3]
#print(paste(b, e, f, g, h,((g>0) | (b>0) | (f<0.11)) ))
y =((m))/(1+exp(g*(log(dat.pred$x)-log(h))))
dat.pred=cbind(dat.pred,y)
}
colnames(dat.pred)=c("x", seq(1, ncol(dat.pred)-1,1))
dat.pred=data.frame(dat.pred[1],stack(dat.pred[2:ncol(dat.pred)]))
x=seq(0,95,1)
pred=data.frame(x)
for (j in levels(factor(subdat4$Accession))) {
y=((subdat4$d[subdat4$Accession==j]))/(1+exp(subdat4$b[subdat4$Accession==j]*(log(x)-log(subdat4$e[subdat4$Accession==j]))))
pred=cbind(pred,y)
}
colnames(pred)=c("x",levels(factor(subdat4$Accession)))
pred=data.frame(pred[1],stack(pred[2:ncol(pred)]))
colnames(pred)=c("x","y","Accession")
predL= ((mod1$coefficients[2]))/(1+exp(mod1$coefficients[1]*(log(x)-log(mod1$coefficients[3]))))
print(ggplot()+
geom_line(aes(x=-dat.pred$x+10, y=dat.pred$values, group=dat.pred$ind ), alpha=0.1, size=0.2)+
geom_line(aes(x=-pred$x+10,y=pred$y, col=pred$Accession), lty=2, size=0.7)+
geom_line(aes(x=-x+10, y=predL), size=0.6)+
geom_point(aes(x=subdat$RealT, y=subdat$L, fill=subdat$Accession), shape=21, position = position_dodge(width=2), size=2.5)+
scale_y_continuous(limits=c(-10,110), breaks=c(0,25,50,75,100))+
ylab("Electrolyte Leakage (% Nitrogen Leakage)") + xlab("Temperature (°C)") +
labs(col="Accession",fill="Accession")+
ggtitle(i)+
theme_bw(base_size = 14)+
theme(legend.position = c(0.8,0.8),
legend.text.align= 1,
legend.text = element_text(size=12),
panel.grid.minor = element_blank(),
legend.background = element_rect(fill="transparent"),
legend.key = element_rect( fill = NA),
panel.border = element_rect(size=1),
axis.text=element_text(color="black"))
)
for (i in levels(dat1$Species)) {
subdat=subset(dat1, Species %in% i)
subdat4=subset(dat4, Accession %in% levels(factor(subdat$Accession)))
mod1=drm((subdat$L)~subdat$posRT, fct=LL.4(fixed=c(NA,0,NA,NA)), start=c(-7.3,60,30), upperl =c(0,90,40) , type="continuous" )
(vc <- vcov(mod1))
coef(summary(mod1))[, "Std. Error"]
sqrt(diag(vc))
require("MASS")
set.seed(345)
nsim <- 5000
sim <- mvrnorm(nsim, mu = coef(mod1),  Sigma = vc)
head(sim)
take <- data.frame(sample(nrow(sim), 100)) ## take 25 simulations at random
colnames(take)="take"
dat.pred=NULL
dat.pred$x=seq(0,95,1)
dat.pred=data.frame(dat.pred)
for (j in take$take){
g=sim[j,1]
m=sim[j,2]
h=sim[j,3]
#print(paste(b, e, f, g, h,((g>0) | (b>0) | (f<0.11)) ))
y =((m))/(1+exp(g*(log(dat.pred$x)-log(h))))
dat.pred=cbind(dat.pred,y)
}
colnames(dat.pred)=c("x", seq(1, ncol(dat.pred)-1,1))
dat.pred=data.frame(dat.pred[1],stack(dat.pred[2:ncol(dat.pred)]))
x=seq(0,95,1)
pred=data.frame(x)
for (j in levels(factor(subdat4$Accession))) {
y=((subdat4$d[subdat4$Accession==j]))/(1+exp(subdat4$b[subdat4$Accession==j]*(log(x)-log(subdat4$e[subdat4$Accession==j]))))
pred=cbind(pred,y)
}
colnames(pred)=c("x",levels(factor(subdat4$Accession)))
pred=data.frame(pred[1],stack(pred[2:ncol(pred)]))
colnames(pred)=c("x","y","Accession")
predL= ((mod1$coefficients[2]))/(1+exp(mod1$coefficients[1]*(log(x)-log(mod1$coefficients[3]))))
print(ggplot()+
geom_line(aes(x=-dat.pred$x+10, y=dat.pred$values, group=dat.pred$ind ), alpha=0.1, size=0.2)+
geom_line(aes(x=-pred$x+10,y=pred$y, col=pred$Accession), lty=2, size=0.7)+
geom_line(aes(x=-x+10, y=predL), size=0.6)+
geom_point(aes(x=subdat$RealT, y=subdat$L, fill=subdat$Accession), shape=21, position = position_dodge(width=2), size=2.5)+
scale_y_continuous(limits=c(-10,110), breaks=c(0,25,50,75,100))+
ylab("Electrolyte Leakage (% Nitrogen Leakage)") + xlab("Temperature (°C)") +
labs(col="Accession",fill="Accession")+
ggtitle(i)+
theme_bw(base_size = 14)+
theme(legend.position = c(0.8,0.8),
legend.text.align= 1,
legend.text = element_text(size=12),
panel.grid.minor = element_blank(),
legend.background = element_rect(fill="transparent"),
legend.key = element_rect( fill = NA),
panel.border = element_rect(size=1),
axis.text=element_text(color="black"))
)
}
mod1=drm((subdat$L)~subdat$posRT, fct=LL.4(fixed=c(NA,0,NA,NA)), start=c(-7.3,50,30), upperl =c(0,90,40) , type="continuous" )
for (i in levels(dat1$Species)) {
subdat=subset(dat1, Species %in% i)
subdat4=subset(dat4, Accession %in% levels(factor(subdat$Accession)))
mod1=drm((subdat$L)~subdat$posRT, fct=LL.4(fixed=c(NA,0,NA,NA)), start=c(-7.3,50,30), upperl =c(0,90,40) , type="continuous" )
(vc <- vcov(mod1))
coef(summary(mod1))[, "Std. Error"]
sqrt(diag(vc))
require("MASS")
set.seed(345)
nsim <- 5000
sim <- mvrnorm(nsim, mu = coef(mod1),  Sigma = vc)
head(sim)
take <- data.frame(sample(nrow(sim), 100)) ## take 25 simulations at random
colnames(take)="take"
dat.pred=NULL
dat.pred$x=seq(0,95,1)
dat.pred=data.frame(dat.pred)
for (j in take$take){
g=sim[j,1]
m=sim[j,2]
h=sim[j,3]
#print(paste(b, e, f, g, h,((g>0) | (b>0) | (f<0.11)) ))
y =((m))/(1+exp(g*(log(dat.pred$x)-log(h))))
dat.pred=cbind(dat.pred,y)
}
colnames(dat.pred)=c("x", seq(1, ncol(dat.pred)-1,1))
dat.pred=data.frame(dat.pred[1],stack(dat.pred[2:ncol(dat.pred)]))
x=seq(0,95,1)
pred=data.frame(x)
for (j in levels(factor(subdat4$Accession))) {
y=((subdat4$d[subdat4$Accession==j]))/(1+exp(subdat4$b[subdat4$Accession==j]*(log(x)-log(subdat4$e[subdat4$Accession==j]))))
pred=cbind(pred,y)
}
colnames(pred)=c("x",levels(factor(subdat4$Accession)))
pred=data.frame(pred[1],stack(pred[2:ncol(pred)]))
colnames(pred)=c("x","y","Accession")
predL= ((mod1$coefficients[2]))/(1+exp(mod1$coefficients[1]*(log(x)-log(mod1$coefficients[3]))))
print(ggplot()+
geom_line(aes(x=-dat.pred$x+10, y=dat.pred$values, group=dat.pred$ind ), alpha=0.1, size=0.2)+
geom_line(aes(x=-pred$x+10,y=pred$y, col=pred$Accession), lty=2, size=0.7)+
geom_line(aes(x=-x+10, y=predL), size=0.6)+
geom_point(aes(x=subdat$RealT, y=subdat$L, fill=subdat$Accession), shape=21, position = position_dodge(width=2), size=2.5)+
scale_y_continuous(limits=c(-10,110), breaks=c(0,25,50,75,100))+
ylab("Electrolyte Leakage (% Nitrogen Leakage)") + xlab("Temperature (°C)") +
labs(col="Accession",fill="Accession")+
ggtitle(i)+
theme_bw(base_size = 14)+
theme(legend.position = c(0.8,0.8),
legend.text.align= 1,
legend.text = element_text(size=12),
panel.grid.minor = element_blank(),
legend.background = element_rect(fill="transparent"),
legend.key = element_rect( fill = NA),
panel.border = element_rect(size=1),
axis.text=element_text(color="black"))
)
}
mod1=drm((subdat$L)~subdat$posRT, fct=LL.4(fixed=c(NA,0,NA,NA)), start=c(-7.3,55,30), upperl =c(0,90,40) , type="continuous" )
mod1=drm((subdat$L)~subdat$posRT, fct=LL.4(fixed=c(NA,0,NA,NA)), start=c(-7.3,45,30), upperl =c(0,90,40) , type="continuous" )
for (i in levels(dat1$Species)) {
subdat=subset(dat1, Species %in% i)
subdat4=subset(dat4, Accession %in% levels(factor(subdat$Accession)))
mod1=drm((subdat$L)~subdat$posRT, fct=LL.4(fixed=c(NA,0,NA,NA)), start=c(-7.3,45,30), upperl =c(0,90,40) , type="continuous" )
(vc <- vcov(mod1))
coef(summary(mod1))[, "Std. Error"]
sqrt(diag(vc))
require("MASS")
set.seed(345)
nsim <- 5000
sim <- mvrnorm(nsim, mu = coef(mod1),  Sigma = vc)
head(sim)
take <- data.frame(sample(nrow(sim), 100)) ## take 25 simulations at random
colnames(take)="take"
dat.pred=NULL
dat.pred$x=seq(0,95,1)
dat.pred=data.frame(dat.pred)
for (j in take$take){
g=sim[j,1]
m=sim[j,2]
h=sim[j,3]
#print(paste(b, e, f, g, h,((g>0) | (b>0) | (f<0.11)) ))
y =((m))/(1+exp(g*(log(dat.pred$x)-log(h))))
dat.pred=cbind(dat.pred,y)
}
colnames(dat.pred)=c("x", seq(1, ncol(dat.pred)-1,1))
dat.pred=data.frame(dat.pred[1],stack(dat.pred[2:ncol(dat.pred)]))
x=seq(0,95,1)
pred=data.frame(x)
for (j in levels(factor(subdat4$Accession))) {
y=((subdat4$d[subdat4$Accession==j]))/(1+exp(subdat4$b[subdat4$Accession==j]*(log(x)-log(subdat4$e[subdat4$Accession==j]))))
pred=cbind(pred,y)
}
colnames(pred)=c("x",levels(factor(subdat4$Accession)))
pred=data.frame(pred[1],stack(pred[2:ncol(pred)]))
colnames(pred)=c("x","y","Accession")
predL= ((mod1$coefficients[2]))/(1+exp(mod1$coefficients[1]*(log(x)-log(mod1$coefficients[3]))))
print(ggplot()+
geom_line(aes(x=-dat.pred$x+10, y=dat.pred$values, group=dat.pred$ind ), alpha=0.1, size=0.2)+
geom_line(aes(x=-pred$x+10,y=pred$y, col=pred$Accession), lty=2, size=0.7)+
geom_line(aes(x=-x+10, y=predL), size=0.6)+
geom_point(aes(x=subdat$RealT, y=subdat$L, fill=subdat$Accession), shape=21, position = position_dodge(width=2), size=2.5)+
scale_y_continuous(limits=c(-10,110), breaks=c(0,25,50,75,100))+
ylab("Electrolyte Leakage (% Nitrogen Leakage)") + xlab("Temperature (°C)") +
labs(col="Accession",fill="Accession")+
ggtitle(i)+
theme_bw(base_size = 14)+
theme(legend.position = c(0.8,0.8),
legend.text.align= 1,
legend.text = element_text(size=12),
panel.grid.minor = element_blank(),
legend.background = element_rect(fill="transparent"),
legend.key = element_rect( fill = NA),
panel.border = element_rect(size=1),
axis.text=element_text(color="black"))
)
}
mod1=drm((subdat$L)~subdat$posRT, fct=LL.4(fixed=c(NA,0,NA,NA)), start=c(-7.3,40,30), upperl =c(0,90,40) , type="continuous" )
mod1=drm((subdat$L)~subdat$posRT, fct=LL.4(fixed=c(NA,0,NA,NA)), start=c(-7.3,47,30), upperl =c(0,90,40) , type="continuous" )
mod1=drm((subdat$L)~subdat$posRT, fct=LL.4(fixed=c(NA,0,NA,NA)), start=c(-7.3,50,30), upperl =c(0,90,40) , type="continuous" )
View(subdat4)
mean(subdat4$d)
mod1=drm((subdat$L)~subdat$posRT, fct=LL.4(fixed=c(NA,0,NA,NA)), start=c(-7.3,mean(subdat4$d),30), upperl =c(0,90,40) , type="continuous" )
for (i in levels(dat1$Species)) {
subdat=subset(dat1, Species %in% i)
subdat4=subset(dat4, Accession %in% levels(factor(subdat$Accession)))
mod1=drm((subdat$L)~subdat$posRT, fct=LL.4(fixed=c(NA,0,NA,NA)), start=c(-7.3,mean(subdat4$d),30), upperl =c(0,90,40) , type="continuous" )
(vc <- vcov(mod1))
coef(summary(mod1))[, "Std. Error"]
sqrt(diag(vc))
require("MASS")
set.seed(345)
nsim <- 5000
sim <- mvrnorm(nsim, mu = coef(mod1),  Sigma = vc)
head(sim)
take <- data.frame(sample(nrow(sim), 100)) ## take 25 simulations at random
colnames(take)="take"
dat.pred=NULL
dat.pred$x=seq(0,95,1)
dat.pred=data.frame(dat.pred)
for (j in take$take){
g=sim[j,1]
m=sim[j,2]
h=sim[j,3]
#print(paste(b, e, f, g, h,((g>0) | (b>0) | (f<0.11)) ))
y =((m))/(1+exp(g*(log(dat.pred$x)-log(h))))
dat.pred=cbind(dat.pred,y)
}
colnames(dat.pred)=c("x", seq(1, ncol(dat.pred)-1,1))
dat.pred=data.frame(dat.pred[1],stack(dat.pred[2:ncol(dat.pred)]))
x=seq(0,95,1)
pred=data.frame(x)
for (j in levels(factor(subdat4$Accession))) {
y=((subdat4$d[subdat4$Accession==j]))/(1+exp(subdat4$b[subdat4$Accession==j]*(log(x)-log(subdat4$e[subdat4$Accession==j]))))
pred=cbind(pred,y)
}
colnames(pred)=c("x",levels(factor(subdat4$Accession)))
pred=data.frame(pred[1],stack(pred[2:ncol(pred)]))
colnames(pred)=c("x","y","Accession")
predL= ((mod1$coefficients[2]))/(1+exp(mod1$coefficients[1]*(log(x)-log(mod1$coefficients[3]))))
print(ggplot()+
geom_line(aes(x=-dat.pred$x+10, y=dat.pred$values, group=dat.pred$ind ), alpha=0.1, size=0.2)+
geom_line(aes(x=-pred$x+10,y=pred$y, col=pred$Accession), lty=2, size=0.7)+
geom_line(aes(x=-x+10, y=predL), size=0.6)+
geom_point(aes(x=subdat$RealT, y=subdat$L, fill=subdat$Accession), shape=21, position = position_dodge(width=2), size=2.5)+
scale_y_continuous(limits=c(-10,110), breaks=c(0,25,50,75,100))+
ylab("Electrolyte Leakage (% Nitrogen Leakage)") + xlab("Temperature (°C)") +
labs(col="Accession",fill="Accession")+
ggtitle(i)+
theme_bw(base_size = 14)+
theme(legend.position = c(0.8,0.8),
legend.text.align= 1,
legend.text = element_text(size=12),
panel.grid.minor = element_blank(),
legend.background = element_rect(fill="transparent"),
legend.key = element_rect( fill = NA),
panel.border = element_rect(size=1),
axis.text=element_text(color="black"))
)
}
coef(summary(mod1))[, "Std. Error"]
summary(mod1)
View(subdat4)
View(subdat)
mod1=drm((subdat$L)~subdat$posRT, fct=LL.4(fixed=c(NA,0,NA,NA)), start=c(-7.3,mean(subdat4$d),35), upperl =c(0,90,40) , type="continuous" )
mod1=drm((subdat$L)~subdat$posRT, fct=LL.4(fixed=c(NA,0,NA,NA)), start=c(-7.3,50,35), upperl =c(0,90,40) , type="continuous" )
mod1=drm((subdat$L)~subdat$posRT, fct=LL.4(fixed=c(NA,0,NA,NA)), start=c(-7.3,50,30), upperl =c(0,90,40) , type="continuous" )
mod1=drm((subdat$L)~subdat$posRT, fct=LL.4(fixed=c(NA,0,NA,NA)), start=c(-7.3,50,25), upperl =c(0,90,40) , type="continuous" )
for (i in levels(dat1$Species)) {
subdat=subset(dat1, Species %in% i)
subdat4=subset(dat4, Accession %in% levels(factor(subdat$Accession)))
mod1=drm((subdat$L)~subdat$posRT, fct=LL.4(fixed=c(NA,0,NA,NA)), start=c(-7.3,50,25), upperl =c(0,90,40) , type="continuous" )
(vc <- vcov(mod1))
coef(summary(mod1))[, "Std. Error"]
sqrt(diag(vc))
require("MASS")
set.seed(345)
nsim <- 5000
sim <- mvrnorm(nsim, mu = coef(mod1),  Sigma = vc)
head(sim)
take <- data.frame(sample(nrow(sim), 100)) ## take 25 simulations at random
colnames(take)="take"
dat.pred=NULL
dat.pred$x=seq(0,95,1)
dat.pred=data.frame(dat.pred)
for (j in take$take){
g=sim[j,1]
m=sim[j,2]
h=sim[j,3]
#print(paste(b, e, f, g, h,((g>0) | (b>0) | (f<0.11)) ))
y =((m))/(1+exp(g*(log(dat.pred$x)-log(h))))
dat.pred=cbind(dat.pred,y)
}
colnames(dat.pred)=c("x", seq(1, ncol(dat.pred)-1,1))
dat.pred=data.frame(dat.pred[1],stack(dat.pred[2:ncol(dat.pred)]))
x=seq(0,95,1)
pred=data.frame(x)
for (j in levels(factor(subdat4$Accession))) {
y=((subdat4$d[subdat4$Accession==j]))/(1+exp(subdat4$b[subdat4$Accession==j]*(log(x)-log(subdat4$e[subdat4$Accession==j]))))
pred=cbind(pred,y)
}
colnames(pred)=c("x",levels(factor(subdat4$Accession)))
pred=data.frame(pred[1],stack(pred[2:ncol(pred)]))
colnames(pred)=c("x","y","Accession")
predL= ((mod1$coefficients[2]))/(1+exp(mod1$coefficients[1]*(log(x)-log(mod1$coefficients[3]))))
print(ggplot()+
geom_line(aes(x=-dat.pred$x+10, y=dat.pred$values, group=dat.pred$ind ), alpha=0.1, size=0.2)+
geom_line(aes(x=-pred$x+10,y=pred$y, col=pred$Accession), lty=2, size=0.7)+
geom_line(aes(x=-x+10, y=predL), size=0.6)+
geom_point(aes(x=subdat$RealT, y=subdat$L, fill=subdat$Accession), shape=21, position = position_dodge(width=2), size=2.5)+
scale_y_continuous(limits=c(-10,110), breaks=c(0,25,50,75,100))+
ylab("Electrolyte Leakage (% Nitrogen Leakage)") + xlab("Temperature (°C)") +
labs(col="Accession",fill="Accession")+
ggtitle(i)+
theme_bw(base_size = 14)+
theme(legend.position = c(0.8,0.8),
legend.text.align= 1,
legend.text = element_text(size=12),
panel.grid.minor = element_blank(),
legend.background = element_rect(fill="transparent"),
legend.key = element_rect( fill = NA),
panel.border = element_rect(size=1),
axis.text=element_text(color="black"))
)
}
mod1=drm((subdat$L)~subdat$posRT, fct=LL.4(fixed=c(NA,0,NA,NA)), start=c(-7.3,50,20), upperl =c(0,90,40) , type="continuous" )
for (i in levels(dat1$Species)) {
subdat=subset(dat1, Species %in% i)
subdat4=subset(dat4, Accession %in% levels(factor(subdat$Accession)))
mod1=drm((subdat$L)~subdat$posRT, fct=LL.4(fixed=c(NA,0,NA,NA)), start=c(-7.3,50,20), upperl =c(0,90,40) , type="continuous" )
(vc <- vcov(mod1))
coef(summary(mod1))[, "Std. Error"]
sqrt(diag(vc))
require("MASS")
set.seed(345)
nsim <- 5000
sim <- mvrnorm(nsim, mu = coef(mod1),  Sigma = vc)
head(sim)
take <- data.frame(sample(nrow(sim), 100)) ## take 25 simulations at random
colnames(take)="take"
dat.pred=NULL
dat.pred$x=seq(0,95,1)
dat.pred=data.frame(dat.pred)
for (j in take$take){
g=sim[j,1]
m=sim[j,2]
h=sim[j,3]
#print(paste(b, e, f, g, h,((g>0) | (b>0) | (f<0.11)) ))
y =((m))/(1+exp(g*(log(dat.pred$x)-log(h))))
dat.pred=cbind(dat.pred,y)
}
colnames(dat.pred)=c("x", seq(1, ncol(dat.pred)-1,1))
dat.pred=data.frame(dat.pred[1],stack(dat.pred[2:ncol(dat.pred)]))
x=seq(0,95,1)
pred=data.frame(x)
for (j in levels(factor(subdat4$Accession))) {
y=((subdat4$d[subdat4$Accession==j]))/(1+exp(subdat4$b[subdat4$Accession==j]*(log(x)-log(subdat4$e[subdat4$Accession==j]))))
pred=cbind(pred,y)
}
colnames(pred)=c("x",levels(factor(subdat4$Accession)))
pred=data.frame(pred[1],stack(pred[2:ncol(pred)]))
colnames(pred)=c("x","y","Accession")
predL= ((mod1$coefficients[2]))/(1+exp(mod1$coefficients[1]*(log(x)-log(mod1$coefficients[3]))))
print(ggplot()+
geom_line(aes(x=-dat.pred$x+10, y=dat.pred$values, group=dat.pred$ind ), alpha=0.1, size=0.2)+
geom_line(aes(x=-pred$x+10,y=pred$y, col=pred$Accession), lty=2, size=0.7)+
geom_line(aes(x=-x+10, y=predL), size=0.6)+
geom_point(aes(x=subdat$RealT, y=subdat$L, fill=subdat$Accession), shape=21, position = position_dodge(width=2), size=2.5)+
scale_y_continuous(limits=c(-10,110), breaks=c(0,25,50,75,100))+
ylab("Electrolyte Leakage (% Nitrogen Leakage)") + xlab("Temperature (°C)") +
labs(col="Accession",fill="Accession")+
ggtitle(i)+
theme_bw(base_size = 14)+
theme(legend.position = c(0.8,0.8),
legend.text.align= 1,
legend.text = element_text(size=12),
panel.grid.minor = element_blank(),
legend.background = element_rect(fill="transparent"),
legend.key = element_rect( fill = NA),
panel.border = element_rect(size=1),
axis.text=element_text(color="black"))
)
}
dat11=dat4[c(2,3,4,5,6)]
colnames(dat11)=c("Accession","Species","bN","dN","eN")
dat6=read.csv("ResultsbyAccession-L_boiling.csv")
dat12=dat6[c(3,4,5,6)]
colnames(dat12)=c("Accession","Species","bL","eL")
dat13=merge(dat11,dat12)
x=seq(0,95,1)
pred=data.frame(x)
pred2=pred
x=seq(0,95,1)
pred=data.frame(x)
pred2=pred
for (j in levels(factor(dat13$Accession))) {
y=(100)/(1+exp(dat13$bL[dat13$Accession==j]*(log(x)-log(dat13$eL[dat13$Accession==j]))))
y2=(dat13$dN[dat13$Accession==j])/
(1+exp(dat13$bN[dat13$Accession==j]*(log(x)-log(dat13$eN[dat13$Accession==j]))))
pred=cbind(pred,y)
pred2=cbind(pred2,y2)
}
colnames(pred)=c("x",levels(factor(dat13$Accession)))
pred=data.frame(pred[1],stack(pred[2:ncol(pred)]))
colnames(pred)=c("x","y","Accession")
colnames(pred2)=c("x",levels(factor(dat13$Accession)))
pred2=data.frame(pred2[1],stack(pred2[2:ncol(pred2)]))
colnames(pred2)=c("x","y2","Accession")
pred3=merge(pred,pred2)
pred5=NULL
for (j in levels(pred3$Accession)) {
pred4=subset(pred3, Accession %in% j)
for (i in seq(1,99,1) ) {
newx=pred4$x[abs(pred4$y-i)==min(abs(pred4$y-i)) ]
newx2=pred4$x[abs(pred4$y2-i)==min(abs(pred4$y2-i)) ]
pred5=rbind(pred5, c(j,i,newx,newx2))
}
}
pred5=data.frame(pred5)
colnames(pred5)=c("Accession","Temperature","Rely","Ny")
pred5[,2]=as.numeric(as.character(pred5[,2]))
pred5[,3]=as.numeric(as.character(pred5[,3]))
pred5[,4]=as.numeric(as.character(pred5[,4]))
pred5$EL50=0
for (j in levels(pred5$Accession)) {
pred5$EL50[pred5$Accession==j]=dat12$eL[dat12$Accession==j]
}
pred5$dif=(pred5$Rely-pred5$Ny)
ggplot()+
geom_col(aes(x=pred5$Temperature,y=abs(pred5$dif), group=pred5$Accession),stat="identity",position = "identity", fill="gray30", alpha=0.1)+
geom_smooth(aes(x=pred5$Temperature, y=abs(pred5$dif)), method="loess", span=0.2)+
theme_bw(base_size = 14)
ggplot()+
geom_point(aes(x=pred5$Temperature, y=pred5$dif), alpha=0.1)+
geom_smooth(aes(x=pred5$Temperature, y=pred5$dif))
ggplot()+
geom_point(aes(x=pred5$Temperature, y=-pred5$EL50+pred5$Damy), alpha=0.2)+
geom_smooth(aes(x=pred5$Temperature, y=-pred5$EL50+pred5$Damy))+
theme_bw()
ggplot()+
geom_col(aes(x=pred5$Temperature,y=(-pred5$EL50+pred5$Ny), group=pred5$Accession),position = "identity", alpha=0.1)+
geom_smooth(aes(x=pred5$Temperature, y=(-pred5$EL50+pred5$Ny)))+
scale_x_continuous(limits=c(0,100),breaks=c(0,10,20,30,40,50,60,70,80,90,100))+
xlab("% Visual damage")+ylab("Prediction difference from 50% Leakage (°C)")+
theme_bw(base_size = 20)+
theme(panel.grid.minor=element_blank())
